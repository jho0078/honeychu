<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <link rel="icon" href="<%= BASE_URL %>favicon.ico">
  <link href="https://fonts.googleapis.com/css?family=Noto+Sans+KR&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Kanit:400,500,600,700,800,900&display=swap" rel="stylesheet">
  <script src="https://kit.fontawesome.com/d213a4d5ba.js" crossorigin="anonymous"></script>
  <script>
    function checkLoginStatus() {
      var loginBtn = document.querySelector('#loginBtn');
      var nameTxt = document.querySelector('#name');
      console.log('checkLoginStatus');
      if (googleAuthObj.isSignedIn.get()) {
        console.log('logined');
        loginBtn.value = 'Logout';
        var profile = googleAuthObj.currentUser.get().getBasicProfile();
        console.log(profile.getName());
        nameTxt.innerHTML = 'Wecome <strong>' + 'profile.getName()+</String> ';
        // document.querySelector('#name').innerHTML = 'Hello, ' + googleAuthObj.currentUser.get().getBasicProfile()
        //   .getName() + '  ';
      } else {
        console.log('logouted');
        loginBtn.value = 'Login';
        nameTxt.innerHTML = '';
        // document.querySelector('#name').innerHTML = '';
      }
    }

    function init() {
      console.log('init');
      gapi.load('auth2', function () {
        console.log('auth2');
        // 전역변수를 만들기 위해 window
        window.googleAuthObj = gapi.auth2.init({
          client_id: '921792176788-9jc07d8lfmsvkvvocm1m5aaccpj84ftg.apps.googleusercontent.com'
        });
        googleAuthObj.then(function () {
          console.log('googleAuth success');
          checkLoginStatus();
        }, function () {
          console.log('googleAuth fail');
        })
      });
    }
  </script>
  <title>HoneyChu</title>
</head>

<body>
  <span id="name"></span><input type="button" id="loginBtn" value="checking..." onclick="
    if(this.value === 'Login'){
      googleAuthObj.signIn().then(function(){
        console.log('gauth.signIn()');
        checkLoginStatus();
      });
    } else {
      googleAuthObj.signOut().then(function(){
        console.log('gauth.signOut()');
        checkLoginStatus();
      });
    }
  ">
  <noscript>
    <strong>We're sorry but frontend doesn't work properly without JavaScript enabled. Please enable it to
      continue.</strong>
  </noscript>
  <div id="app"></div>
  <!-- built files will be auto injected -->
  <!-- auth 초기화(init) -->
  <script src="https://apis.google.com/js/platform.js?onload=init" async defer></script>
</body>

</html>